#TIL Template

## 날짜: 2025-02-06

### 스크럼

- 네트워크 관련 내용 공유

### 새로 배운 내용

### 주제 1: L2에서의 동작

- 스위치에서는 Mac 주소 기반으로 동작한다.(MAC 주소 테이블, IP주소는 모름)
- 특정 노드의 arp cache에 목적지의 MAC 주소가 없다면 Apr?? 스위치에 보냄
- 스위치에서는 broadcasting(출발지 제위)을 통해 해당 IP에 해당하는 NODE에서 Apr?? 스위치에 보냄.
- 

### 주제 2: NAT

- DNAT(Destination NAT):
- SNAT(Source NAT):

### 주제 3: DNS

- IP주소를 사람이 알아보기 쉽게 만듦
- DNS 주소를 사용하면
    1. DNS 주소와 맵핑된 IP주소가 있음 ⇒ 해당 IP 주소 사용
    2. DNS 주소에 맵핑된 IP주소가 없을 경우
        1. 저장된 DNS 서버 IP 사용(DHCP가 저장해줌)
            1. 저장된 DNS 서버에 해당 DNS가 있을 경우
            2. 저장된 DNS 서버에 해당 DNS가 없을 경우

### 주제 4: Trunk

- 하나의 물리적 포트를 여러 개의 논리적 인터페이스와 연결해주는 기술
- 이를 통해 스위치 간에 VLAN을 설정해도 포트가 여러 개 필요 없음 + 라우터에서 각 스위치마다 포트를 가질 필요 없음.

### 주제 5: DHCP

다음은 정리된 내용입니다. 잘못된 내용은 수정하고, 부족한 부분은 보완했습니다.

---

## **주제 1: L2에서의 동작 (스위치와 ARP)**

- **스위치는 L2(데이터 링크 계층)에서 동작하며, MAC 주소 기반으로 패킷을 전달한다.**
    - **스위치 MAC 주소 테이블(MAC Address Table, CAM Table)** 을 사용하여 목적지 MAC 주소를 찾음.
    - **스위치는 IP 주소를 모름** (IP는 L3(네트워크 계층)에서 사용됨).
- **특정 노드(PC)의 ARP 캐시에 목적지 MAC 주소가 없을 경우 ARP 요청을 브로드캐스트한다.**
    - "이 IP 주소의 MAC 주소를 아는 사람?" → `FF:FF:FF:FF:FF:FF` 로 브로드캐스트
    - 같은 네트워크(서브넷)에 있는 모든 노드가 해당 요청을 받음.
- **스위치의 역할**
    - 스위치는 ARP 요청을 MAC 주소 테이블과 비교 후, 특정 포트로 전달하거나 모든 포트로 플러딩(Flooding)함.
    - 만약 스위치가 해당 MAC 주소를 모르면, 브로드캐스트하여 네트워크에 전파함.
    - 목적지 장치가 ARP 응답을 보내면, 스위치는 MAC 주소를 학습하여 이후 해당 MAC 주소로의 트래픽을 최적화하여 전달함.

✅ **즉, ARP 요청은 같은 서브넷에서만 동작하며, 스위치는 이를 MAC 주소 기반으로 처리한다.** 🚀

---

## **주제 2: NAT (Network Address Translation)**

NAT는 내부 네트워크의 사설 IP를 공인 IP로 변환하는 기술이며, **SNAT(출발지 변환)** 과 **DNAT(목적지 변환)** 두 가지 방식이 있음.

### **1️⃣ SNAT (Source NAT, 출발지 주소 변환)**

📌 **클라이언트가 인터넷으로 나갈 때 내부 사설 IP를 공인 IP로 변경**

➡ **목적지 서버는 클라이언트의 실제 내부 IP를 모름**

- **사용 예시**:
    - 내부 네트워크(192.168.1.10)가 외부 서버(8.8.8.8)로 요청을 보낼 때, 라우터가 출발지 IP를 공인 IP로 변환함.
    - **예제**
        - 요청: `192.168.1.10 → 8.8.8.8` (출발지 변경 필요)
        - NAT 변환: `203.0.113.10 → 8.8.8.8`
        - 응답: `8.8.8.8 → 203.0.113.10`
        - NAT 변환 후 내부 전달: `8.8.8.8 → 192.168.1.10`

✅ **SNAT는 내부 IP를 숨기고, 하나의 공인 IP를 여러 장치가 공유하도록 해줌.** 🚀

---

### **2️⃣ DNAT (Destination NAT, 목적지 주소 변환)**

📌 **외부에서 내부 네트워크로 들어오는 트래픽의 목적지 IP를 내부 IP로 변경**

➡ **공인 IP가 내부 서버로 매핑됨**

- **사용 예시**:
    - 인터넷에서 특정 서비스(예: 웹 서버)를 접근할 때, 공인 IP를 내부 서버의 사설 IP로 변환.
    - **예제**
        - 요청: `외부 클라이언트(203.0.113.50) → 203.0.113.10 (공인 IP)`
        - NAT 변환: `203.0.113.50 → 192.168.1.100 (내부 웹 서버)`
        - 응답: `192.168.1.100 → 203.0.113.50`

✅ **DNAT는 외부에서 내부 네트워크의 특정 서버로 트래픽을 전달할 때 사용됨.** 🚀

---

## **주제 3: DNS (Domain Name System)**

📌 **DNS는 사람이 이해하기 쉬운 도메인 이름을 IP 주소로 변환하는 시스템.**

### **1️⃣ DNS 요청 과정**

1. 사용자가 `www.google.com` 입력
2. OS가 **DNS 캐시 확인** (이전에 요청한 IP가 있으면 사용)
3. 없으면, OS는 **설정된 DNS 서버(예: 8.8.8.8)에 질의**
4. DNS 서버는 **IP 주소가 있다면 즉시 반환**, 없다면 **계층적으로 조회**
    - 루트 DNS → `.com` TLD DNS → `google.com`의 권한 DNS
5. 클라이언트가 반환된 IP 주소(142.250.190.36)를 사용하여 웹 서버에 접속

📌 **DNS 요청 시 내부 프로세스**

- **DHCP가 클라이언트에게 DNS 서버의 IP를 제공함.**
- **로컬 DNS 서버가 존재하는 경우, 먼저 로컬 캐시 확인 후 외부 DNS에 질의.**

✅ **즉, DNS는 계층적 구조를 사용하여 도메인 → IP 매핑을 수행한다!** 🚀

---

## **주제 4: Trunk (트렁크 포트와 VLAN 연동)**

📌 **Trunk는 하나의 물리적 포트에서 여러 개의 VLAN을 처리할 수 있도록 하는 기술.**

### **1️⃣ Trunk의 개념**

- 기본적으로 스위치 포트는 하나의 VLAN만 처리 가능.
- **트렁크 포트(Trunk Port)** 를 사용하면 **여러 개의 VLAN을 하나의 링크를 통해 전송 가능**.
- **802.1Q 태깅**을 사용하여 패킷이 어느 VLAN에 속하는지 표시.

### **2️⃣ Trunk의 장점**

- VLAN이 많아도 물리적 포트 수를 줄일 수 있음.
- 스위치 간 VLAN 정보를 공유할 수 있음.
- 라우터가 모든 VLAN마다 별도 포트를 가질 필요 없음.

📌 **예제: 두 개의 스위치가 VLAN 10과 VLAN 20을 공유할 때**

```
[Switch A] ----[Trunk]---- [Switch B]
  VLAN 10      VLAN 10
  VLAN 20      VLAN 20

```

✅ **즉, Trunk 포트는 VLAN 태그를 사용하여 여러 VLAN을 단일 링크에서 처리할 수 있다!** 🚀

---

## **주제 5: DHCP (Dynamic Host Configuration Protocol)**

📌 **DHCP는 네트워크 장치에 자동으로 IP 주소를 할당하는 프로토콜.**

### **1️⃣ DHCP의 주요 기능**

- IP 주소 자동 할당
- 서브넷 마스크, 게이트웨이, DNS 서버 정보 제공
- IP 주소 임대(Lease) 및 갱신

### **2️⃣ DHCP 작동 과정 (DORA)**

| 단계 | 설명 |
| --- | --- |
| **1️⃣ Discover** | 클라이언트가 "IP 주소 주세요!" 브로드캐스트 요청 |
| **2️⃣ Offer** | DHCP 서버가 사용 가능한 IP 주소를 제안 |
| **3️⃣ Request** | 클라이언트가 특정 IP 주소 사용 요청 |
| **4️⃣ Acknowledgment** | DHCP 서버가 최종 승인 및 IP 할당 |

📌 **DHCP의 장점**

- 수동 IP 설정 필요 없음 → 네트워크 관리 용이
- IP 충돌 방지 → DHCP 서버가 IP를 관리
- 네트워크 변경 시 자동 업데이트 가능

✅ **즉, DHCP는 네트워크 장치가 IP 주소를 자동으로 받아 사용할 수 있도록 해주는 필수 프로토콜이다!** 🚀

---

## **📌 최종 정리**

| 주제 | 핵심 개념 |
| --- | --- |
| **L2 동작** | MAC 주소 기반 스위칭, ARP를 통한 MAC 주소 학습 |
| **NAT** | SNAT(출발지 변경), DNAT(목적지 변경) |
| **DNS** | 도메인 → IP 변환, 계층적 질의 구조 |
| **Trunk** | VLAN 간 태깅을 통한 다중 VLAN 처리 |
| **DHCP** | 자동 IP 할당 (DORA 프로세스) |

✅ **이제 모든 개념이 명확하게 정리됨! 🚀**

### 오늘의 회고

- 기존에 알지못했던 Network의 하위 레이어?에 대해 알게 자세히 알게 되었습니다.
- 저녁먹고 늘어져서 9시에 시작하는 건 문제가 있었다.

### 참고 자료 및 링크

- ChatGPT